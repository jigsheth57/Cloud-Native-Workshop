<!DOCTYPE html>
<html>
<head>
<title>WebSocket Stomp Receiving Message</title>
<script src="js/jquery.min.js"></script>
<script type="text/javascript"
	src="//cdn.jsdelivr.net/sockjs/0.3.4/sockjs.min.js"></script>
<script type="text/javascript"
	src="//cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
<link rel="stylesheet" href="css/bootstrap.css" />
<link rel="stylesheet" href="css/bootstrap-theme.css" />
</head>
<body>
	<div class="container">
		<div class="row">
			<div class="col-md-10">
				<h3>
					<em><u>Contact Change Notifications</u></em>
				</h3>
			</div>
		</div>
		<div class="row">
			<div class="col-md-10">
				<table class="table table-striped">
					<thead>
						<tr>
							<th>Type</th>
							<th>Date</th>
							<th>Id</th>
							<th>Name</th>
							<th>Title</th>
							<th>Phone</th>
							<th>Email</th>
						</tr>
					</thead>
					<tbody id="messages">
					</tbody>
				</table>
			</div>
		</div>
	</div>
	<script type="text/javascript">
		$(document).ready(
				function() {
					var messageList = $("#messages");
					// defined a connection to a new socket endpoint
					var socket = new SockJS('/stomp');
					var stompClient = Stomp.over(socket);
					stompClient.connect({}, function(frame) {
						// subscribe to the /topic/message endpoint
						stompClient.subscribe("/topic/message",
								function(data) {
									console.log('data: ' + data);
									var message = JSON.parse(data.body);
									console.log('message: ' + message);
									messageList.append("<tr>");
									messageList.append("<td>" + message.Status
											+ "</td>");
									messageList.append("<td>" + message.Date
											+ "</td>");
									messageList.append("<td>"
											+ message.Contact.Id + "</td>");
									messageList.append("<td>"
											+ message.Contact.firstName
											+ "&nbsp;"
											+ message.Contact.lastName
											+ "</td>");
									messageList.append("<td>"
											+ message.Contact.title + "</td>");
									messageList.append("<td>"
											+ message.Contact.phone + "</td>");
									messageList.append("<td>"
											+ message.Contact.email + "</td>");
									messageList.append("</tr>");
								});
					});
				});
	</script>
</body>
</html>